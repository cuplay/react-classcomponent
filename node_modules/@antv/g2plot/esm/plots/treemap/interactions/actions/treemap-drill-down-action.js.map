{"version":3,"file":"treemap-drill-down-action.js","sourceRoot":"","sources":["../../../../../src/plots/treemap/interactions/actions/treemap-drill-down-action.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,UAAU,CAAC;AAClC,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,YAAY,CAAC;AAC1C,OAAO,EAAE,aAAa,EAAE,MAAM,aAAa,CAAC;AAE5C;IAA4C,0CAAM;IAAlD;QAAA,qEAsCC;QArCC,eAAe;QACR,oBAAc,GAA4B,EAAE,CAAC;;IAoCtD,CAAC;IAlCC,sCAAK,GAAL,UAAM,IAAI;QACA,IAAA,IAAI,GAAK,IAAI,CAAC,OAAO,KAAjB,CAAkB;QAC9B,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QACnC,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,IAAM,eAAe,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC,cAAc,EAAE,oBAAoB,EAAE,KAAK,EAAE,iBAAiB,CAAC,EAAE,EAAE,CAAC,CAAC;QAExG,eAAe;QACf,IAAM,SAAS,GAAG,aAAa,CAAC;YAC9B,IAAI,MAAA;YACJ,UAAU,EAAE,GAAG,CAAC,WAAW,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAC1C,aAAa,EAAE,IAAI;YACnB,eAAe,iBAAA;SAChB,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAC3B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACxC,CAAC;IAEM,sCAAK,GAAZ;QACE,IAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;QAC1D,IAAI,CAAC,IAAI;YAAE,OAAO,KAAK,CAAC;QACxB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACnB,CAAC;IAEM,sCAAK,GAAZ;QACU,IAAA,IAAI,GAAK,IAAI,CAAC,OAAO,KAAjB,CAAkB;QAC9B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,IAAI,CAAC,EAAE;YACpE,OAAO;SACR;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;QAEhF,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IAChC,CAAC;IACH,6BAAC;AAAD,CAAC,AAtCD,CAA4C,MAAM,GAsCjD","sourcesContent":["import { Action } from '@antv/g2';\nimport { get, isArray } from '@antv/util';\nimport { transformData } from '../../utils';\n\nexport class TreemapDrillDownAction extends Action {\n  // 存储历史下钻 scale\n  public cacheDataStack: Record<string, any>[][] = [];\n\n  drill(data) {\n    const { view } = this.context;\n    const currentData = view.getData();\n    const groupScales = view.getGroupScales();\n    const hierarchyConfig = get(view, ['interactions', 'treemap-drill-down', 'cfg', 'hierarchyConfig'], {});\n\n    // 重新 update 数据\n    const drillData = transformData({\n      data,\n      colorField: get(groupScales, [0, 'field']),\n      openDrillDown: true,\n      hierarchyConfig,\n    });\n\n    view.changeData(drillData);\n    this.cacheDataStack.push(currentData);\n  }\n\n  public click() {\n    const data = get(this.context, ['event', 'data', 'data']);\n    if (!data) return false;\n    this.drill(data);\n  }\n\n  public reset() {\n    const { view } = this.context;\n    if (!isArray(this.cacheDataStack) || this.cacheDataStack.length <= 0) {\n      return;\n    }\n\n    const cacheData = this.cacheDataStack.splice(this.cacheDataStack.length - 1, 1);\n\n    view.changeData(cacheData[0]);\n  }\n}\n"]}