{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../../src/plots/sunburst/utils.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,iCAAiC,CAAC;AAC5D,OAAO,EAAE,OAAO,EAAE,MAAM,+BAA+B,CAAC;AAGxD;;;GAGG;AACH,MAAM,UAAU,aAAa,CAAC,OAAwB;IAC5C,IAAA,IAAI,GAAqD,OAAO,KAA5D,EAAE,IAAI,GAA+C,OAAO,KAAtD,EAAE,WAAW,GAAkC,OAAO,YAAzC,EAAE,UAAU,GAAsB,OAAO,WAA7B,EAAE,eAAe,GAAK,OAAO,gBAAZ,CAAa;IACzE,IAAM,SAAS,GAAG;QAChB,SAAS,EAAE,SAAS;QACpB,OAAO,EAAE,OAAO;KACjB,CAAC;IACF,IAAM,KAAK,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,wBAC7B,eAAe;QAClB,aAAa;QACb,IAAI,EAAE,eAAa,IAAM,EACzB,KAAK,EAAE,WAAW,EAClB,EAAE,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,IACd,CAAC;IAEH,IAAM,MAAM,GAAG,EAAE,CAAC;IAClB,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;;;QACjB,IAAI,IAAI,CAAC,KAAK,KAAK,CAAC,EAAE;YACpB,OAAO,IAAI,CAAC;SACb;QACD,IAAM,QAAQ,yBACX,WAAW,IAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,iBAAI,IAAI,CAAC,MAAM,0CAAE,IAAI,0CAAG,WAAW,EAAC,KACxE,UAAU,IAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,iBAAI,IAAI,CAAC,MAAM,0CAAE,IAAI,0CAAG,UAAU,EAAC,OACnE,IAAI,CACR,CAAC;QACF,QAAQ,CAAC,GAAG,GAAG,eAAe,CAAC;QAC/B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACxB,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC;AAED;;;;;;;GAOG;AACH,MAAM,UAAU,kBAAkB,CAAC,MAKlC;IACS,IAAA,KAAK,GAAwB,MAAM,MAA9B,EAAE,SAAS,GAAa,MAAM,UAAnB,EAAE,MAAM,GAAK,MAAM,OAAX,CAAY;IACtC,IAAA,KAA+B,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,EAA3C,KAAK,WAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAmB,CAAC,CAAC,UAAU;IAC/D,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC/C,SAAS,CAAC,SAAS,GAAG,YAAY,CAAC;IACnC,IAAI,QAAQ,GAAG,EAAE,CAAC;IAClB,IAAM,aAAa,GAAG,UAAC,IAAI,EAAE,KAAK;;QAChC,IAAI,SAAS,EAAE;YACb,OAAO,SAAS,uBAAM,IAAI,KAAE,KAAK,OAAA,IAAG,CAAC;SACtC;QACD,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAG,KAAK,aAAK,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,IAAI,0CAAG,KAAK,EAAC,EAAE,CAAC;IACtE,CAAC,CAAC;IAEF,MAAM,CAAC,OAAO,CAAC,UAAC,KAAK;QACb,IAAA,KAAkB,aAAa,CAAC,IAAI,EAAE,KAAK,CAAC,EAA1C,IAAI,UAAA,EAAE,KAAK,WAA+B,CAAC;QACnD,QAAQ,IAAI,mKACwB,CAAA,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,KAAK,KAAI,KAAK,iLAEvB,IAAI,qEACG,KAAK,wCAE9C,CAAC;IACT,CAAC,CAAC,CAAC;IACH,SAAS,CAAC,SAAS,GAAG,QAAQ,CAAC;IAC/B,OAAO,SAAS,CAAC;AACnB,CAAC","sourcesContent":["import { partition } from '../../utils/hierarchy/partition';\nimport { treemap } from '../../utils/hierarchy/treemap';\nimport { SunburstOptions } from './types';\n\n/**\n * sunburst 处理数据\n * @param options\n */\nexport function transformData(options: SunburstOptions) {\n  const { data, type, seriesField, colorField, hierarchyConfig } = options;\n  const transform = {\n    partition: partition,\n    treemap: treemap,\n  };\n  const nodes = transform[type](data, {\n    ...hierarchyConfig,\n    // @ts-ignore\n    type: `hierarchy.${type}`,\n    field: seriesField,\n    as: ['x', 'y'],\n  });\n\n  const result = [];\n  nodes.forEach((node) => {\n    if (node.depth === 0) {\n      return null;\n    }\n    const nodeInfo = {\n      [seriesField]: node.data[seriesField] || node.parent?.data?.[seriesField],\n      [colorField]: node.data[colorField] || node.parent?.data?.[colorField],\n      ...node,\n    };\n    nodeInfo.ext = hierarchyConfig;\n    result.push(nodeInfo);\n  });\n\n  return result;\n}\n\n/**\n * customContent\n * @param {string} value\n * @param {any[]} items\n * @param {Function} formatter\n * @param {string} field\n * @returns HTMLElement\n */\nexport function getTooltipTemplate(params: {\n  value: string;\n  items: any[];\n  formatter?: (item: any) => { name: string; value: string | number };\n  fields?: string[];\n}): HTMLElement {\n  const { items, formatter, fields } = params;\n  const { color, mappingData, data } = items[0] || {}; // 不会有分组情况\n  const container = document.createElement('ul');\n  container.className = 'g2-tooltip';\n  let listItem = '';\n  const formatterItem = (item, field) => {\n    if (formatter) {\n      return formatter({ ...item, field });\n    }\n    return { name: field, value: item?.[field] || item?.data?.[field] };\n  };\n\n  fields.forEach((field) => {\n    const { name, value } = formatterItem(data, field);\n    listItem += `<li class=\"g2-tooltip-list-item\" data-index={index} style=\"margin-bottom:4px;display:flex;align-items: center;\">\n        <span style=\"background-color:${mappingData?.color || color};\" class=\"g2-tooltip-marker\"></span>\n        <span style=\"display:inline-flex;flex:1;justify-content:space-between\">\n        <span style=\"margin-right: 16px;\">${name}:</span>\n        <span class=\"g2-tooltip-list-item-value\">${value}</span>\n        </span>\n    </li>`;\n  });\n  container.innerHTML = listItem;\n  return container;\n}\n"]}